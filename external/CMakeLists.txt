include(ExternalProject)

find_package(Git)
if(GIT_FOUND)
    message(STATUS "Checking submodules")
    include(check_submodule)
    check_submodule(nghttp2)
    check_submodule(spdlog)
    check_submodule(wslay)
endif()

set(ENABLE_LIB_ONLY OFF CACHE BOOL "")
set(ENABLE_DOC OFF CACHE BOOL "")
set(BUILD_STATIC_LIBS ON CACHE BOOL "")
set(BUILD_SHARED_LIBS OFF CACHE BOOL "")
add_subdirectory(nghttp2 EXCLUDE_FROM_ALL)
add_library(nghttp2::nghttp2 ALIAS nghttp2_static)

set(WSLAY_CONFIGURE_INSTALL OFF CACHE BOOL "")
set(WSLAY_STATIC ON CACHE BOOL "")
set(WSLAY_SHARED OFF CACHE BOOL "")
add_subdirectory(wslay EXCLUDE_FROM_ALL)
add_library(wslay::wslay ALIAS wslay)

set(SPDLOG_USE_STD_FORMAT OFF CACHE BOOL "")
set(SPDLOG_FMT_EXTERNAL ON CACHE BOOL "")
add_compile_definitions(SPDLOG_ACTIVE_LEVEL=0)
add_subdirectory(spdlog)
